{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "defba5c6_a84beace",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 7,
      "author": {
        "id": 1007145
      },
      "writtenOn": "2021-02-05T04:46:49Z",
      "side": 1,
      "message": "would prefer:\n\n sync: delete project tags when remote URL changes",
      "revId": "867d0765499fc966209ef8a8a17266f0783eb69c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "84111714_6290c7a4",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1007145
      },
      "writtenOn": "2021-02-05T04:46:49Z",
      "side": 1,
      "message": "i have a few concerns with this proposal.\n\nfirst, there is a chance for data loss.  consider that users can create as many tags as they want in their local repos independent of the remote.  switching remotes doesn\u0027t delete their history or branches, but this would delete their tags.  maybe a mitigation would be to see what tags exist in the old remote and only clear those if they match the local tags.\n\nsecond, the check here is comparing the fully constructed URL.  consider that we allow people to switch remotes easily to support mirrors/caches better.  maybe your company has an internal mirror that updates once a day, so you sync against that to catch up, but then you switch to the public live version to get the very latest changes before uploading or pushing.  by comparing against the full URL, it would cause tags to get deleted \u0026 refetched everytime the user switched mirror\u003c-\u003elive remotes.  it probably isn\u0027t normally a significant amount of data as all the objects should still exist locally just without names, but it\u0027s still constant thrashing.\n\nfinally, what you\u0027re doing goes against the model that repo has long used.  it is explained here:\nhttps://gerrit.googlesource.com/git-repo/+/HEAD/docs/internal-fs-layout.md#project-objects\nit doesn\u0027t seem to be noted in our manifest docs though ... prob should add it somewhere.\n\nso all things considered, i don\u0027t think we want to adopt this behavior, nor encourage the idea that the same \u003cproject name\u003d...\u003e can refer to completely different things based on the remote\u003d... attribute.  if it\u0027s something you do, you should be able to work around it by using --force-sync when syncing.  if that doesn\u0027t work, we should fix it.",
      "revId": "867d0765499fc966209ef8a8a17266f0783eb69c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "08c0d702_82d81143",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1125410
      },
      "writtenOn": "2021-02-05T10:18:46Z",
      "side": 1,
      "message": "\u003e if that doesn\u0027t work, we should fix it.\n\nProvided script already uses --force-sync option during each sync operation - it doesn\u0027t work for this particular case. Should I change my proposal so that it cleans old tags only if --force-sync is provided? Of course, with respect to the review notes.",
      "parentUuid": "84111714_6290c7a4",
      "revId": "867d0765499fc966209ef8a8a17266f0783eb69c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e04b6c3c_c34e1711",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1125410
      },
      "writtenOn": "2021-02-05T10:18:46Z",
      "side": 1,
      "message": "Hello, Mike.\nWe may clean tags only with --force-sync option provided. What do you think of this?\n\nPS\nI\u0027m sorry I didn\u0027t reply to the previous review comments. \nI\u0027m new to gerrit, and I missed that my replies were in draft state. My fault ðŸ˜ž",
      "revId": "867d0765499fc966209ef8a8a17266f0783eb69c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8f324cbe_44bb72f7",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1007145
      },
      "writtenOn": "2021-02-05T18:27:45Z",
      "side": 1,
      "message": "thanks, i took another (closer) look.  i think the tags are a red herring.  there is a bug here that we need to fix, but clearing tags wouldn\u0027t be sufficient to workaround it.\n\ni filed https://crbug.com/gerrit/14051 with some details.  i won\u0027t have time to get to it though if you want to take a look.",
      "parentUuid": "08c0d702_82d81143",
      "revId": "867d0765499fc966209ef8a8a17266f0783eb69c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7158a7e2_9e031b66",
        "filename": "project.py",
        "patchSetId": 2
      },
      "lineNbr": 453,
      "author": {
        "id": 1007145
      },
      "writtenOn": "2021-02-05T04:46:49Z",
      "side": 1,
      "message": "while correct, it\u0027s unrelated, so best to omit whitespace changes like this",
      "revId": "867d0765499fc966209ef8a8a17266f0783eb69c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5de6ec17_91d962f8",
        "filename": "project.py",
        "patchSetId": 2
      },
      "lineNbr": 1038,
      "author": {
        "id": 1007145
      },
      "writtenOn": "2021-02-05T04:46:49Z",
      "side": 1,
      "message": "this isn\u0027t deleting \"cache\", it\u0027s deleting all local tags",
      "revId": "867d0765499fc966209ef8a8a17266f0783eb69c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8e817241_52fbed00",
        "filename": "project.py",
        "patchSetId": 2
      },
      "lineNbr": 1040,
      "author": {
        "id": 1007145
      },
      "writtenOn": "2021-02-05T04:46:49Z",
      "side": 1,
      "message": "cuddle this up to the previous line",
      "revId": "867d0765499fc966209ef8a8a17266f0783eb69c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}